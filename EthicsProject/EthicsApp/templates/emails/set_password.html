{% extends "master.html" %}
{% load static %}

{% block css %}
<link rel="stylesheet" href="{% static 'css/index.css' %}">
<script type="module" src="{% static 'js/appearance.js' %}"></script>
{% endblock %}

{% block content %}
<body>
  {% include "nav.html" %}

  <div class="password-reset-container">
    <h2>Secure Your Account: Set a New Password</h2>
    
    {% if role %}
        <p><strong>Account Role:</strong> {{ role }}</p>
        <p>You are configuring a password for your {{ role | title }} account. Please follow the guidelines below to ensure your account remains secure.</p>
    {% endif %}
    
    <p>To protect your account, please set a new password that meets the following requirements:</p>

    <div id="messages3">
        {% if messages %}
            {% for message in messages %}
                <div class="message3 {% if message.tags %}{{ message.tags }}{% endif %}">
                    <div class="{% if 'success' in message.tags %}message-success3{% elif 'error' in message.tags %}message-error3{% else %}message-info2{% endif %}">
                        {{ message }}
                    </div>
                </div>
            {% endfor %}
        {% endif %}
    </div>

    <form method="post">
        {% csrf_token %}
        
        <div class="form-group">
            <label for="new-password">New Password:</label>
            <input type="password" id="new-password" name="new_password1" class="form-control" required>
            <small class="form-text text-muted">
                Your password should:
                <ul>
                    <li>Be at least 6 characters in length.</li>
                    <li>Contain a mix of letters, numbers, and symbols.</li>
                    <li>Avoid common patterns and should not be entirely numeric (e.g., "123456" is not acceptable).</li>
                </ul>
            </small>
        </div>

        <div class="form-group">
            <label for="new-password-confirm">Confirm New Password:</label>
            <input type="password" id="new-password-confirm" name="new_password2" class="form-control" required>
            <small class="form-text text-muted">Please re-enter the new password to confirm it.</small>
        </div>

        <button type="submit" class="btn btn-primary">Set New Password</button>
    </form>
  </div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const messages = document.getElementById('messages3');
        const messageElements = messages.children;

        if (messageElements.length > 0) {
            let delay = 100;

            Array.from(messageElements).forEach((message, index) => {
                setTimeout(() => {
                    message.style.display = "flex";

                    setTimeout(() => {
                        message.style.display = "none";
                    }, 4000);
                }, delay);

                delay += 4400;
            });
        }
    });
</script>
</body>
{% endblock %}


